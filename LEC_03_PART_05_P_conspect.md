# Создание переменной с несколькими значениями

## Определение переменной «Температура»

В данном разделе рассматривается создание переменной *температура*, которая будет принимать четыре значения: холодная, прохладная, тёплая или жаркая.

### Условие для переменной

Для определения значения переменной *температура* используются следующие условия:

1. Если температура меньше 0, то значение переменной — «холодная».
2. Если температура от 0 до 15, то значение переменной — «прохладная».
3. Если температура от 15 до 26, то значение переменной — «тёплая».
4. Если температура больше 26, то значение переменной — «жаркая».

```mermaid
flowchart TD
    A[Температура] --> B{Температура < 0?}
    B -- Да --> C[Холодная]
    B -- Нет --> D{Температура от 0 до 15?}
    D -- Да --> E[Прохладная]
    D -- Нет --> F{Температура от 15 до 26?}
    F -- Да --> G[Тёплая]
    F -- Нет --> H[Жаркая]
```

Диаграмма выше иллюстрирует процесс определения значения переменной *температура* на основе заданных условий.

![](images/LEC_03_PART_05_P/000060s_top_6.jpg)

### Вложенные функции «если»

Для реализации условий используется вложенная функция «если». Это позволяет последовательно проверять условия и присваивать соответствующее значение переменной.

## Обработка пустых ячеек

При работе с данными может возникнуть ситуация, когда ячейка с температурой пуста. В этом случае необходимо предусмотреть условие, чтобы переменная *температура* также оставалась пустой.

Для этого добавляется дополнительное условие в начале функции «если»: если ячейка C2 пуста, то ячейка с температурой также должна быть пустой. Только если в ячейке C2 есть значение, начинается проверка условий для определения температуры.

```mermaid
flowchart TD
    A[Ячейка C2 пуста?] -- Да --> B[Пустая температура]
    A -- Нет --> C{Проверка условий}
```

Диаграмма показывает логику обработки пустых ячеек в данных.

![](images/LEC_03_PART_05_P/000468s_top_3.jpg)

## Анализ данных с помощью фильтра

После внесения изменений в формулу можно использовать фильтр для анализа данных. Например, можно узнать количество записей с определённым типом температуры.

![](images/LEC_03_PART_05_P/000508s_top_8.jpg)

### Пример использования фильтра

- Отбор записей с тёплой температурой показывает 2778 записей.
- Отбор записей с холодной температурой показывает 1412 записей.

## Заключение

В результате мы научились создавать переменные, которые принимают несколько значений со сложными условиями, а также проверять, являются ли наши значения пустыми, и прописывать функции для тех случаев, когда у нас есть пропущенное значение.