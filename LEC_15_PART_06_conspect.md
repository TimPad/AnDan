# Обработка признаков для линейных моделей

## Категориальные признаки

Для линейных моделей необходимо аккуратно обрабатывать признаки, особенно категориальные.

### Проблема включения категориальных переменных

Категориальные переменные, такие как цвет (Red, Yellow, Green), не могут быть включены в модель напрямую, так как модель плохо работает со строками.

#### Label Encoding

* **Label Encoding** — процедура кодирования значений переменной уникальными числами. Например, Red = 1, Yellow = 2 и т. д.

Однако использование Label Encoding в линейной регрессии не рекомендуется по следующим причинам:

* Создаётся неявный порядок на категории, который может быть неверным.
* Метки (числа) не являются настоящими числами, а только создают порядок.

#### One-Hot Encoding

Корректный способ кодирования категориальных переменных для линейной регрессии — **One-Hot Encoding**.

* Создаётся *N* новых признаков, где *N* — количество уникальных значений в категориальной переменной.
* Если в категориальной переменной для наблюдения встречается значение *k*, то в соответствующем столбце ставится 1, а во все остальные столбцы — 0.

При использовании One-Hot Encoding следует учитывать:

* Исключение одной из категорий (базовой категории) для избежания ситуации абсолютной линейной зависимости.
* Быстрое увеличение количества признаков при большом количестве категорий, что может затруднить обучение модели.

```mermaid
graph LR
    A[Категориальная переменная] --> B[Label Encoding]
    A --> C[One-Hot Encoding]
    B --> D[Числовые метки]
    C --> E[Бинарные признаки]
```

*Диаграмма иллюстрирует два основных метода кодирования категориальных переменных: Label Encoding и One-Hot Encoding.*

![](images/LEC_15_PART_06/000139s_top_4.jpg)
![](images/LEC_15_PART_06/000159s_top_3.jpg)
![](images/LEC_15_PART_06/000169s_top_2.jpg)

## Обработка числовых признаков

Числовые признаки можно включать в модель как есть, удалив из них выбросы и пропущенные значения. Однако для большей стабильности рекомендуется масштабировать числовые признаки.

Пример масштабирования: вычесть из признака его среднее и поделить на стандартное отклонение.

Масштабирование приводит к потере простой статистической интерпретации признака, но обеспечивает большую численную стабильность и позволяет интерпретировать оценки коэффициентов по степени их важности.

```mermaid
flowchart LR
    A[Числовой признак] --> B[Удаление выбросов]
    B --> C[Заполнение пропущенных значений]
    C --> D[Масштабирование]
    D --> E[Готовый признак]
```

*Диаграмма показывает последовательность обработки числовых признаков для линейных моделей.*

![](images/LEC_15_PART_06/000209s_top_6.jpg)
![](images/LEC_15_PART_06/000239s_top_5.jpg)