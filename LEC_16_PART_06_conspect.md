# Реализация модели логистической регрессии в Scikit-Learn

## Постановка задачи

Логистическая регрессия применяется для решения задач бинарной классификации. В данном случае рассматривается её применение для классификации данных в линейно разделимом и линейно неразделимом случаях.

### Линейно разделимый случай

Логистическая регрессия находится в модуле `Scikit-Learn linear model`. Для её использования импортируется `LogisticRegression`, интерфейс которой полностью соответствует интерфейсу `LinearRegression`.

```mermaid
flowchart TD
    A[Подгрузка стандартных данных и набора данных] --> B[Разбиение выборки на обучающую и тестовую]
    B --> C[Кодирование значений: фиолетовому классу присваивается 1, остальным — -1]
    C --> D[Построение графика для тренировочной выборки]
    D --> E[Обучение логистической регрессии на тренировочной выборке]
    E --> F[Предсказание на тренировочной и тестовой выборках]
    F --> G[Расчёт доли правильных ответов accuracy_score]
```

В линейно разделимом случае значение `accuracy_score` как на обучающей, так и на тестовой выборках равно 1, что свидетельствует о возможности идеальной классификации наблюдений.

![](images/LEC_16_PART_06/000189s_top_3.jpg)  
![](images/LEC_16_PART_06/000219s_top_6.jpg)  
![](images/LEC_16_PART_06/000229s_top_1.jpg)  

### Линейно неразделимый случай

Для построения выборки в линейно неразделимом случае необходимо перекодировать целевую переменную.

```mermaid
flowchart TD
    A[Переимпортирование набора данных] --> B[Перекодировка целевой переменной: классу 1 присваивается 1, остальным — -1]
    B --> C[Разбиение выборки на тренировочную и тестовую]
    C --> D[Построение графика для тренировочной выборки]
    D --> E[Обучение модели LogisticRegression]
    E --> F[Предсказание на тренировочной и тестовой выборках]
    F --> G[Расчёт доли правильных ответов accuracy_score]
```

В линейно неразделимом случае `accuracy_score` на тренировочной выборке составляет примерно 0,64, на тестовой — 0,85, что свидетельствует о невозможности достижения максимальной точности классификации.

![](images/LEC_16_PART_06/000388s_top_2.jpg)  
![](images/LEC_16_PART_06/000488s_top_7.jpg)  

## Предсказание вероятности

С помощью логистической регрессии можно решать задачу мягкой классификации, используя метод `predict_proba`. Этот метод позволяет получить предсказание вероятностей принадлежности наблюдения к каждому из классов.

![](images/LEC_16_PART_06/000627s_top_8.jpg)  

## Регуляризация

Стратегия регуляризации в логистической регрессии реализуется при помощи тех же параметров, что и в случае линейной регрессии. Модуль `LogisticRegression` по умолчанию поддерживает регуляризацию. При инициализации модели логистической регрессии можно указать следующие параметры:

```mermaid
classDiagram
    class LogisticRegression {
        +Penalty : тип регуляризации (по умолчанию L2)
        +C : обратная сила регуляризации
    }
```

- `Penalty` — тип регуляризации (по умолчанию L2).  
- `C` — обратная сила регуляризации (чем больше C, тем менее применима регуляризация).  

![](images/LEC_16_PART_06/000797s_top_4.jpg)  