# Корреляционный анализ в Pandas

## Агрегация данных и подготовка к анализу

Для начала необходимо агрегировать данные по неделям, чтобы найти среднюю недельную температуру и суммарное количество арендованных велосипедов.

### Процесс агрегации данных

```mermaid
flowchart LR
    A[Исходные данные] --> B[Группировка по неделям]
    B --> C[Средняя температура за неделю]
    B --> D[Сумма арендованных велосипедов за неделю]
    C --> E[Объединение данных]
    D --> E
    E --> F[Итоговый датафрейм]
```

1. **Группировка данных по неделям:**
   - Используем метод `groupby` для группировки данных по неделям.
   - Находим среднее значение температуры за неделю.
   - Находим суммарное количество арендованных велосипедов за неделю.

2. **Объединение данных в один датафрейм:**
   - Используем функцию `concat` из библиотеки Pandas для объединения двух векторов одинаковой размерности в один датафрейм.
   - Указываем параметр `axis=1`, чтобы объединить данные по колонкам.

![](images/LEC_7_part_3_P/000229s_top_4.jpg)

## Расчет коэффициента корреляции

Для расчета коэффициента корреляции между средней температурой в неделю и количеством арендованных велосипедов в эту неделю, можно использовать как ручной расчет, так и функции из библиотеки Pandas.

### Ручной расчет

```mermaid
flowchart LR
    A[Фильтрация первых пяти наблюдений] --> B[Расчет отклонений от среднего]
    B --> C[Расчет суммы квадратов и суммы произведений]
    C --> D[Расчет коэффициента корреляции]
```

1. **Фильтрация первых пяти наблюдений:**
   - Выбираем первые пять наблюдений для наглядности.

2. **Расчет отклонений от среднего:**
   - Для каждой колонки находим отклонение каждого наблюдения от среднего значения.
   - Сохраняем результаты в новые колонки.

3. **Расчет суммы квадратов и суммы произведений:**
   - Находим сумму квадратов отклонений для X и Y.
   - Находим сумму произведений отклонений.

4. **Расчет коэффициента корреляции:**
   - Делим сумму произведений на корень из произведения суммы квадратов X и суммы квадратов Y.

![](images/LEC_7_part_3_P/000508s_top_5.jpg)
![](images/LEC_7_part_3_P/000538s_top_2.jpg)

### Использование функций Pandas

Для проверки расчетов можно использовать функцию `corr` из библиотеки Pandas.

```python
first5['Temperature'].corr(first5['Rental Count'])
```

![](images/LEC_7_part_3_P/000667s_top_10.jpg)

## Построение графика рассеяния

Для визуализации зависимости между температурой и количеством арендованных велосипедов можно построить график рассеяния.

```python
bikes_week.plot(x='Temperature', y='Rental Count', kind='scatter')
```

![](images/LEC_7_part_3_P/000767s_top_6.jpg)

## Заключение

В ходе анализа мы агрегировали данные по неделям, рассчитали коэффициент корреляции между температурой и количеством арендованных велосипедов как вручную, так и с помощью функций Pandas, построили график рассеяния и убедились в наличии линейной зависимости между этими переменными.

![](images/LEC_7_part_3_P/000777s_top_7.jpg)